#!/bin/bash
# This manages the startup of both the site and admin applications.
# As both share the same flat file database, they need to be started up in order.
# So the admin page is run first. Once the curl returns a 200. We know it is running and the
# site is run.

httpstatus=0
./mvnw -f admin/pom.xml spring-boot:run &

while [ $httpstatus -ne 200 ]
do
sleep 5
httpstatus=$(curl --insecure --write-out %{http_code} --silent --output /dev/null https://localhost:8444/admin/login )
done
./mvnw -f site/pom.xml spring-boot:run
